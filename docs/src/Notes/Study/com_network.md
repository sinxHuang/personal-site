---
title: "💻 计算机通信网"
outline: deep
desc: "闭卷+记忆 让人讨厌的一门课"
tags: "本科课程"
updateTime: "2025-10-08 21:33"
---
# 计算机通信网

## 第一章 概述
### 1、什么是计算机网络？（对“自主”的理解）*
+ **定义**：计算机网络是一些**自主计算机的互联集合**。 
+ **对“自主” (Autonomous) 的理解**： 
- 计算机之间没有主从关系（非控制与被控制）。
- 计算机拥有独立的操作系统和通信处理能力，是对等的行为模式。

### 2、计算机网络的应用
计算机网络的应用广泛，主要体现在资源共享和信息交流等方面： 

+ **资源共享**：可以访问Internet上的各种网站（服务器）获取信息和服务。
+ **信息交流**：
- **家庭上网**：通过ADSL等方式接入Internet。 
- **公共场合上网**：如网吧、办公室，通常先组建局域网，再统一接入Internet。 
- **无线上网**：通过AP (Access Point) 接入网络。 
- **移动上网**：通过蜂窝移动通信（如GSM, CDMA）系统接入网络。 

### 3、计算机网络的分类*
#### 从传输技术：信道 
+ **广播式网络** (Broadcast Network)
- **特点**：所有主机共享一条通信信道，一台主机发出的报文，网络上其他所有主机都能收到。
- **拓扑**：一般具有规则的拓扑结构，常用于总线型、环型等规则拓扑结构。
+ **点到点式网络** (Point-to-point Network)
- **特点**：每条物理线路连接一对通信节点，独享信道。主机间的通信通常需要经过中间节点的存储转发。
- **拓扑**：多为网状结构，一发一收。

#### 从覆盖范围 
+ **局域网** (Local Area Network, LAN)
- **距离**： 10m∼1km 。
- **场景**：办公室、大楼、园区。
- **特点**：主要采用广播式网络技术，如以太网。
+ **城域网** (Metropolitan Area Network, MAN)
- **距离**： 1km∼100km 。
- **场景**：覆盖一座城市，如有线电视网、政府专网。
+ **广域网** (Wide Area Network, WAN)
- **距离**：几百 km 到上千 km 。
- **场景**：覆盖国家乃至全球，如ChinaNet。
- **特点**：以点到点网络技术为主，注重连通性。
+ **个域网 & 互联网**
### 4、什么是协议、协议的作用*
+ **定义**：**协议 (Protocol)** 是对等实体（通信双方）为实现通信而共同遵守的一组规则集。 
+ **作用**：协议规定了通信时所发出信息的**格式 (**语法**)**、**含义 (**语义**)** 和**顺序 (**同步**/时序)**，是计算机网络的灵魂。 
+ **协议是实现功能、提供服务的基础，是计算机网络的灵魂**。

### 5、什么是协议体系*
协议体系，即网络体系结构，是计算机网络各层协议的集合。 

+ **垂直分层**：将复杂的网络功能划分到不同层次，每层负责特定的功能。 
+ **协议栈 (Protocol Stack)**：一个特定系统所使用的一组协议，每层一个协议。 
+ **封装 (Encapsulation)**：发送方在传输数据时，每层协议会给上层传来的数据添加本层的控制信息（头部 Header），然后交给下一层。 
+ **解封 (Decapsulation)**：接收方在收到数据时，从最底层开始，每层协议剥离本层的头部信息，并将数据交给上一层，直到最高层。 
+ **接口 (Interface)**：相邻层之间进行交互的地方，定义了下层向上层提供的服务和操作。**服务访问点+服务原语**。 
+ **服务访问点 (Service Access Point, SAP)**：上层实体访问下层服务的“地点”或“逻辑端口”，用于区分不同的上层实体。 

+ **实体 (Entity)**：层中的活跃元素，可以是软件（进程）或硬件，负责执行本层的协议功能。**对等实体**指不同系统中同层存在通信关系的实体。 

### 6、服务方式
+ **面向连接服务** (Connection-Oriented Service)
- **特点**：可靠，保证报文不丢失、不重复、按顺序到达。
- **过程**：通信前需经过 **建立连接 -> 数据传输 -> 拆除连接** 三个阶段。

+ **无连接服务** (Connectionless Service)
- **特点**：不可靠，尽力而为，不保证报文的顺序和可靠性（可能丢失、重复、乱序）。
- **过程**：直接发送数据，无需预先建立连接。

+ **服务质量 (QoS)**：PPT中未明确定义QoS，但通过对比两种服务方式的“可靠”与“不可靠”体现了服务质量的差异。面向连接服务通常能提供更高的服务质量。

### 7、服务与协议的关系* 
+ **区别**：
- **服务 (Service)** 定义了**下层**为**上层**提供的功能，是垂直的。它描述了层的功能，但不关心如何实现。
- **协议 (Protocol)** 定义了**对等**实体之间通信的规则，是水平的。它是对服务的具体实现。
+ **联系**：
- 服务与协议是紧密相关的，某种类型的服务通常需要某种类型的协议来实现。
- 但它们又是相对独立的，一个服务可以由多种协议实现，甚至可以用一种类型的协议（如无连接协议）来实现另一种类型的服务（如面向连接服务）。 

### 8、OSI模型*
#### 分层原则
1. 每层有一个定义明确的功能；
2. 各层间边界（接口）清晰；
3. 适当分层。

#### 七层结构和各层功能 

+ **应用层 (Application Layer)**：为用户应用程序提供网络服务，如文件传输、电子邮件等。 
+ **表示层 (Presentation Layer)**：为应用层要传输的信息内容提供语法和语义表示。处理数据的格式表示、加密和压缩，确保不同系统间能正确理解数据。 

+ **会话层 (Session Layer)**：建立、管理和终止主机间的会话（通信活动），如通话控制、同步等。 
+ **传输层 (Transport Layer)**：提供端到端的可靠或不可靠的数据传输服务，屏蔽底层网络细节。各种网络的适配，网络通信的分流和复用、多个并发通信的管理、流量控制等。

+ **网络层 (Network Layer)**：负责数据包的路由选择和转发，实现数据从源端到目的端的跨网络传输。路由计算、 路由选择、报文分段和重组、拥塞控制、网络互连和组网。
+ **数据链路层 (Data Link Layer)**：在物理链路上提供可靠的帧(Frame)传输，进行成帧、差错检测、差错处理和流量控制。 
+ **物理层 (Physical Layer)**：在物理介质上传输原始的比特(bit)流。 

#### 互连设备的工作层次 
+ **中继器 (Repeater)**：工作在**物理层**，对信号进行再生和放大。
+ **网桥 (Bridge)**：工作在**数据链路层**，连接不同（或相同）类型的局域网，根据MAC地址转发数据帧。
+ **路由器 (Router)**：工作在**网络层**，连接不同的网络，根据IP地址进行路由选择和分组转发。

### 9、OSI模型与TCP/IP模型*
#### TCP/IP模型结构和各层功能 
TCP/IP模型是一个四层结构：

+ **应用层**：对应OSI的应用层、表示层、会话层。包含所有高层协议，如HTTP, FTP。
+ **传输层**：对应OSI的传输层。提供端到端的通信服务，主要协议是TCP和UDP。
+ **网际层 (**IP层**)**：对应OSI的网络层。核心是IP协议，负责分组在网络中的路由。
+ **网络接口层 (**物理网络层**)**：对应OSI的数据链路层和物理层。负责IP分组在具体物理网络（如以太网）上的传输。

#### OSI与TCP/IP模型的关系 
+ **相同点**：
- 都采用垂直分层结构。
- 层次功能大体相似。
+ **差异点**：
- **层次制定不同**：OSI为7层，TCP/IP为4层。
- **服务定义不同**：OSI严格区分服务、接口和协议；TCP/IP则没那么清晰。
- **连接模式**：OSI更倾向于面向连接；TCP/IP提供两种服务方式给用户选择。
- **模型与协议的关系**：OSI是“先有模型，后有协议”，理论性强；TCP/IP是“先有协议，后有模型”，实践性强

### 10、计算类型
#### 数据传输速率与传播延迟
+ **数据传输速率**：指发送端每秒发送的数据位数，单位是 bps (bit per second)。 
+ **(传播)延迟**：指信号在信道上传播一定距离所需的时间。
- **公式**：传播延迟 = 距离/信号传播速率
- 电信号在铜缆中的传播速率约为光速的 2/3 ，即 2×10^8m/s 。 
+ **例题**：小狗传输数据 
- **问题**：一只狗携带3个8GB的U盘，速度为 18km/h 。在什么距离内，它的数据传输速率超过150Mbps的WiFi？（存储单位用1024单位换算）
- **解**：
 * 总数据量 = 3×8×1024×1024×1024×8 bits
 * 小狗速度 = 18km/h=18000m/3600s=5m/s 

 * 设距离为 d 米，则传输时间 t=d/5 秒。
 * 小狗的数据传输速率 = 总数据量/t=(3×8×8×109)/(d/5) bps (近似计算)
 * 令该速率 > 150×106 bps，解出 d 的范围。

#### 位长
+ PPT中未直接给出“位长”的计算，但其概念与数据传输速率和传播速度相关。位长是指1比特在信道上所占的物理长度。
+ **公式**：位长 = 传播速度/数据传输速率 

#### 封装的开销
+ **开销**：各层协议为了实现其功能而添加的头部和尾部信息。
+ **开销比例**： 总开销/总数据长度 

+ **例题1**
- **问题**：系统有 X 层结构，最底层传出 Y 字节数据。除最底层外，每层封装 M 字节头部。开销比例是多少？
- **解**：
 * 顶层应用数据大小 = Y−(X−1)×M 字节
 * 额外开销 = (X−1)×M 字节
 * 开销比例 = $(X−1)×M/Y$ 

+ **例题2**
- **问题**：1000字节应用数据，TCP首部20字节，IP首部20字节，以太网首部和尾部18字节。额外开销是多少？占比多大？
- **解**：
 * 总开销 = 20(TCP)+20(IP)+18(Ethernet)=58 字节
 * 传输的总数据长度 = 1000+58=1058 字节
 * 开销占比 = 58/1058≈5.48%

- --

## 第二章 物理层
### 1、物理层功能*
+ **核心服务**：在物理介质上为数据链路层提供一个透明的、无结构的**比特流 (bit stream) 传输**服务。 
+ **主要功能/协议内容**：物理层协议主要定义与传输介质接口相关的规范，确保原始的比特流数据能够从一端正确传输到另一端。它不关心比特的含义，但要解决比特的传输问题。 

### 2、傅立叶级数与数据传输速率的限制
+ **基本原理**：根据傅立叶分析，任何周期性的信号（如用于传输数据的方波）都可以看作是由一个基频正弦波和多个高次谐波（基频的整数倍）叠加而成。 
+ **带宽的限制**：
- 物理信道都存在带宽限制，即只能让一定频率范围内的信号通过。高频率的谐波会被信道衰减或过滤掉。 
- 丢失的高次谐波越多，信号波形失真就越严重，接收端就越难分辨信号的原始形态（例如，方波变得圆滑），从而导致误判。 
+ **对数据速率的影响**：
- 为了保证信号能被正确识别，必须保留足够多的谐波分量。
- 一个信道的带宽限制了其能传输的最高谐波频率，也就间接限制了信号变化的最高速率（波特率），最终限制了最大数据传输速率。 

### 3、🌟奈奎斯特定理和香农公式*
#### 奈奎斯特定理 (Nyquist's Theorem)
+ **适用场景**：描述了在**无噪声**的理想信道中，有限带宽下的最大数据传输速率。
+ 公式：$D = 2B \log{2} V$ 
- D ：最大数据传输速率 (bps)
- H ：信道带宽 (Hz)
- V ：信号电平的级数（一个码元所能代表的离散状态数量）
+ **例题**： 
- **问题**：一个带宽为 3kHz 的无噪声信道，如果使用二进制信号（ V=2 ）传输，最大数据传输速率是多少？
- 解：$D = 2 \times 3000 \times \log{2} 2 = 6000 \ \text{bps} = 6 \ \text{kbps}$

#### 香农公式 (Shannon's Formula)
+ **适用场景**：描述了在**有随机噪声**的信道中，有限带宽下的最大数据传输速率（信道容量）。
+ 公式： $C = B \log{2} \left( 1 + \frac{S}{N} \right)$
- C ：信道容量，即理论上的最大数据传输速率 (bps)
- H ：信道带宽 (Hz)
- S/N ：信噪比，即信号功率 (S) 与噪声功率 (N) 的比值。
+ 注意：工程上常用分贝 (dB) 来表示信噪比，换算关系为：$\text{信噪比}(dB) = 10 \log{10} \left( \frac{S}{N} \right)$
+ **例题**： 
- **问题**：一个带宽为 3kHz 的信道，信噪比为 30dB ，其最大数据传输速率是多少？(计算速率时用1000为进制)
- **解**：
 1. 首先将dB转换为S/N：$30 dB = 10 \log{10} \left( \frac{S}{N} \right)$

$\log{10} \left( \frac{S}{N} \right) = 3$

$\frac{S}{N} = 10^3 = 1000$

 2. 代入香农公式：

$C = 3000 \times \log{2} (1 + 1000) = 3000 \times \log{2} 1001 \approx 3000 \times 9.967 \approx 29901 \ \text{bps} \approx 30 \ \text{kbps}$

### 4、传输介质：分类、特点*
#### 有线介质
+ **双绞**线 (Twisted Pair)**(P24-P29)
- **特点**：两根绝缘铜导线相互绞合以抵抗电磁干扰，成本低廉。分为非屏蔽双绞线(UTP)和屏蔽双绞线(STP)。
- **带宽/速率**：5类线(CAT5)支持100MHz带宽，100Mbps速率；6类线(CAT6)支持10Gbps。
- **距离**：通常小于100米。
- **应用**：局域网（以太网）。
+ **同轴电**缆 (Coaxial Cable)**(P30-P34)
- **特点**：由中心铜导体、绝缘层、网状屏蔽层和外层护套构成，抗干扰能力强于双绞线。
- **带宽/速率**：基带同轴电缆支持10Mbps，宽带同轴电缆可达1GHz。
- **距离**：基带可达500m～2km，宽带可达几十公里。
- **应用**：早期局域网、有线电视(CATV)。
+ **光纤（**错误率最低****） (Optical Fiber)**(P35-P39)
- **特点**：利用光的全反射原理传输光信号，具有带宽高、传输距离远、抗电磁干扰、保密性好等优点。
- **带宽/速率**：极高，可达几十Gbps甚至更高。
- **距离**：单模光纤可达上百公里。
- **应用**：广域网干线、高速局域网、城域网。

#### 无线介质 (P40-P44)
+ **特点**：利用在自由空间传播的电磁波进行通信，无需物理布线，支持移动性。

+ **分类与应用**：
- **无线电波**：穿透性好，用于广播、移动通信。
- **微波**：频率高，带宽大，视距传播。用于地面中继通信和卫星通信。
- **红外线**：方向性好，不能穿墙。用于短距离通信，如遥控器。
- **卫星通信**：覆盖范围广，但传播延迟大（GEO卫星约270ms）。

### 5、电话系统
#### 结构 (P52-P53)
公共交换电话网 (PSTN) 主要由三部分组成：

1. **本地回路 (Local Loop)**：用户电话到第一个电话交换局的线路，通常是双绞线，传输模拟信号。
2. **干线 (Trunk)**：连接各个交换局的高速线路，通常是光纤或微波，采用多路复用技术传输数字信号。
3. **交换局 (Switching Office)**：负责建立和拆除电话连接的设备，形成一个层级结构（端局、汇接局、长途局等）。

#### 干线上的多路复用技术 (P63-P68)
为了提高干线的利用率，将多路低速信号合并到一条高速信道上传输。

+ **频分多路复用 (FDM)**：按频率划分信道，将总带宽分割成多个子信道，每路信号占用一个子信道。
+ **时分多路复用 (TDM)**：按时间划分信道，将时间划分为一个个时隙，每路信号轮流占用一个时隙。电话系统中的E1/T1载波就是TDM的应用。
+ **波分多路复用 (WDM)**：光纤上的频分复用，在一根光纤上同时传输多种不同波长（颜色）的光信号。
+ **同步数字系列 (SDH)**(P71-P77)：一种基于TDM的光纤传输网络标准，是现代电话和数据干线网的基础。

### 6、交换技术* 

+ **电路交换** (Circuit Switching)
- **原理**：在通信双方之间建立一条**物理独占**的连接（电路），在整个通信期间，该电路资源被持续占用，直到连接释放。
- **特点**：
 * **优点**：实时性强，时延固定，无拥塞。
 * **缺点**：信道利用率低（即使不传输数据也占用资源），建立连接时间长。
- **应用**：传统电话网。
+ **分组交换** (Packet Switching)
- **原理**：将要传输的数据分割成一个个较小的数据包（分组），每个分组独立地在网络中传输，通过存储-转发的方式到达目的地。网络资源是动态共享的。
- **特点**：
 * **优点**：信道利用率高，灵活，可靠。
 * **缺点**：存在排队时延，时延不固定，可能发生拥塞。
- **应用**：现代计算机网络（Internet）。

### 7、物理层接口的基本类型及四大特性

#### 四大特性 
物理层接口规范定义了设备（如计算机DTE）与网络（如调制解调器DCE）之间的连接标准。

1. **机械特性**：定义接口的物理属性，如**接口外观、尺寸、接插件**。 
2. **电气特性**：定义接口上信号的电气参数，如**电信号的频率、幅度、编码方式等**。 
3. **功能特性**：定义**接口各针脚的功能**，如数据线、控制线、时钟线等。 (P104, P107)
4. **规程特性 (过程特性)**：定义**接口各针脚的工作流程**，即事件发生的合法顺序。 

### 8、计算类型
#### 采样与编码
+ **波特率 (Baud Rate)**：信号每秒钟变化的次数，单位是波特 (Baud)。
+ **比特率 (Bit Rate)**：每秒钟传输的二进制比特数，单位是bps。
+ **关系**：$\text{比特率} = \text{波特率} \times \log{2} V$ ，其中 V 是信号的电平级数。 

#### 多路复用
+ **例题**：欧洲的E1载波 
- **问题**：E1载波将32个 64kbps 的信道进行时分复用，其总数据传输速率是多少？
- 解：$\text{总速率} = 32 \times 64 \ \text{kbps} = 2048 \ \text{kbps} = 2.048 \ \text{Mbps}$

#### 延迟计算
+ **传输时间 (Transmission Time, **Tt**)**
- **定义**：将一个数据块（N bit）从发送端全部推上信道所需的时间。
- **公式**： **Tt=数据块大小(N)/信道速率(R)**
+ **传播延迟 (Propagation Delay, **Tp**)**
- **定义**：一个比特从链路的一端传播到另一端所需的时间。
- **公式**： **Tp=链路长度(D)/信号传播速度(V)**
+ **总延迟**：从发送方开始发送数据，到接收方接收完所有数据，总时间为 **Tt+Tp** 。 
- --

## 第三章 数据链路层
### 1、链路层功能*
+ **对象**：数据链路层负责**直接相连的节点**之间（主机-主机，主机-路由器，路由器-路由器）的通信。 
+ **核心功能**：将物理层提供的可能出错的比特流服务，转变为对网络层无差错的数据链路。 
- **成帧 (Framing)**：将网络层的数据包封装成帧（Frame），并添加帧头和帧尾，以便在比特流中识别。 
- **差错控制 (Error Control)**：检测并可能纠正传输过程中产生的比特差错。 
- **流量控制 (Flow Control)**：协调收发双方的速度，防止快速的发送方淹没慢速的接收方。 
- **链路管理 (Link Management)**：对于面向连接的服务，负责连接的建立、维持和释放。 
+ **三种服务类型**
 1. **无确认的无连接服务**：直接发送数据帧，不建立连接，也不要求对方确认。适用于误码率很低或上层协议会处理差错的情况。
 2. **有确认的无连接服务**：直接发送数据帧，但要求对方对每一帧都进行确认。通过重传增加了可靠性。
 3. **有确认的面向连接服务**：通信前先建立逻辑连接，在连接上双向传输数据帧，并对每一帧进行确认，通信结束后释放连接。提供最可靠的服务。

### 2、成帧技术*
成帧是在比特流中确定帧的边界的过程。 

1. **字节计数法** (Byte Count)
- **原理**：在帧头用2（或者1个）个字节作为帧字节长度计数。
- **特点**：实现简单，但非常脆弱。如果长度字段出错，接收方将彻底失去同步，难以恢复。
2. **带**字符填充**的首尾界符法** (Character Stuffing)
- **原理**：使用特殊的字节（如FLAG 0x7E）作为帧的开始和结束界符。为了防止数据中出现与界符相同的字节而导致混淆，需要在数据中出现的FLAG字节前插入一个特殊的转义字符（ESC 0x7D）。如果数据中本身也出现了ESC，则在ESC前也插入一个ESC。
- **操作**：
 * **发送**：扫描数据，遇到 FLAG 或 ESC，就在其前添加 ESC。
 * **接收**：扫描接收的字节流，遇到 ESC，就删除 ESC 并将其后的字节当作普通数据。
- **特点**：解决了字节计数法的同步问题，但填充操作会增加额外开销。
3. **带**位填充**的首尾标志法** (Bit Stuffing)
- **原理**：使用一个特殊的比特模式（如 01111110）作为帧的开始和结束标志。为防止数据中出现此模式，发送方在扫描数据时，只要遇到连续的5个1，就自动在其后插入一个0。
- **操作**：
 * **发送**：遇到 11111，立即填充一个 0，变成 111110。
 * **接收**：遇到 11111，检查其后的比特。如果是 0，则删除它（这是填充的位）；如果是 1，则判断是否为帧结束标志。
- **特点**：比字符填充更通用，被HDLC等协议采用。
4. **物理层编码违例法** (Physical Layer Coding Violation)
- **原理**：利用物理层编码的冗余性。某些编码（如曼彻斯特编码）中，一些电平转换模式是数据不会使用的“非法”模式。可以用这些非法模式来界定帧的开始和结束。
- **特点**：不需要任何填充，没有额外的数据开销，效率高。

### 3、🌟差错控制
#### 差错检测
+ **奇偶校验** (Parity Check)
- **原理**：在数据末尾附加一位校验位，使得整个码字中1的个数为奇数（奇校验）或偶数（偶校验）。
- **特点**：只能检测出奇数位的错误，无法检测偶数位的错误，漏检率高。

+ **循环冗余校验** (CRC)
- **原理**：将要发送的数据比特串看作一个多项式 M(x) 。收发双方约定一个生成多项式 **G(x) （ r+1 位）**。发送方计算出 r 位的校验码（余数），附加在数据后面，使得附加校验码后的整个码字能被 G(x) 整除。接收方用同样的 G(x) 去除收到的码字，若余数为0，则认为无差错。
- **计算**：
 1. 将数据 **M(x) 左移 r 位**（即后面补 r 个0）。
 2. 用 M(x)左移 r 位 对 G(x) 做模2除法（异或运算，不借位），得到余数 R(x) （即CRC校验码）。
 3. 发送的码字为 T(x)=M(x)+R(x) 。
- **例题**
 * **问题**：数据为 101110，生成多项式 $P(x)=x^3+1$ （即 1001）。求CRC校验码。
 * **解**：
 + G(x) 是4位，所以 r=3。
 + 数据补3个0变为 101110000。
 + 进行模2除法：

plain
101011
1001|101110000
 1001
- ---
 01010
 1001
- ---
 01100
 1001
- ---
 1010
 1001
- ---
 011

 + 余数为 011。所以应发送的数据是 101110011。

#### 差错纠正
+ **海明码88 (Hamming Code) - 前向纠错**
+ 海明距离：两个码字中不同的位的个数。
- **原理**：通过增加冗余的校验位，使得错误的码字与多个正确码字的海明距离（不同比特位的数量）不同，从而可以定位并纠正单个比特的错误。
- **校验位数量**：对于 m 位的数据，需要 r 个校验位，必须满足不等式：$(m + r + 1) \leq 2^{r}$ 
- **计算**
 1. 确定校验位的位置：校验位放在 $2^k$ （1, 2, 4, 8, ...）的位置上。
 2. 确定每个校验位负责校验的数据位：将所有数据位的位置写成二进制，第 k 个校验位负责校验所有位置二进制表示中第 k 位为1的数据位。
 3. 计算校验位的值：每个校验位的值使其所负责的所有位（包括自身）的异或和为0（偶校验）。
- **纠错**：接收方重新计算所有校验位。将出错的校验位的位置编号相加，结果就是出错数据位的位置。

**题目**：请自拟一个10位长的二进制码串，计算其海明纠错编码。将编码后的码串某位翻转，利用海明码进行纠错。（需有计算过程）

**解答**：

我们分两步进行：1. **编码过程** 和 2. **纠错过程**。

**自拟的10位数据**: 1011010011
- --

1. 海明编码过程

第一步：计算校验位数量 (r)

已知数据位 $m = 10$ 。我们需要找到满足海明不等式 $2^r \ge m + r + 1$ 的最小整数 $r$。
- 若 $r=3$ ， $2^3 = 8$ ， $10 + 3 + 1 = 14$ 。 $8 < 14$ ，不满足。
- 若 $r=4$ ， $2^4 = 16$ ， $10 + 4 + 1 = 15$ 。 $16 \ge 15$ ，**满足**。

所以，我们需要 **4** 个校验位 ( $r=4$ )。编码后的总长度为 $m + r = 10 + 4 = 14$ 位。

第二步：确定校验位 (P) 和数据位 (D) 的位置
校验位 $Pi$ 放在 $2^{i-1}$ 的位置上。
- $P1$ 在位置 1
- $P2$ 在位置 2
- $P3$ 在位置 4
- $P4$ 在位置 8

数据位则依次填充到剩余的位置。

| 位置 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 类型 | **P₁** | **P₂** | D₁ | **P₃** | D₂ | D₃ | D₄ | **P₄** | D₅ | D₆ | D₇ | D₈ | D₉ | D₁₀ |
| 数据 | | | 1 | | 0 | 1 | 1 | | 0 | 1 | 0 | 0 | 1 | 1 |

第三步：计算每个校验位的值（采用偶校验）
每个校验位 $Pk$ 的值由一组特定位置的比特值通过异或(XOR)运算决定。一个数据位被哪些校验位所校验，取决于其位置编号的二进制分解。
- **计算 P₁** (校验位置 1, 3, 5, 7, 9, 11, 13)
- 相关数据位：D₁, D₂, D₄, D₅, D₇, D₉
- 值为：1, 0, 1, 0, 0, 1
- $P1 = 1 \oplus 0 \oplus 1 \oplus 0 \oplus 0 \oplus 1 = 1$
- **计算 P₂** (校验位置 2, 3, 6, 7, 10, 11, 14)
- 相关数据位：D₁, D₃, D₄, D₆, D₇, D₁₀
- 值为：1, 1, 1, 1, 0, 1
- $P2 = 1 \oplus 1 \oplus 1 \oplus 1 \oplus 0 \oplus 1 = 1$
- **计算 P₃** (校验位置 4, 5, 6, 7, 12, 13, 14)
- 相关数据位：D₂, D₃, D₄, D₈, D₉, D₁₀
- 值为：0, 1, 1, 0, 1, 1
- $P3 = 0 \oplus 1 \oplus 1 \oplus 0 \oplus 1 \oplus 1 = 0$
- **计算 P₄** (校验位置 8, 9, 10, 11, 12, 13, 14)
- 相关数据位：D₅, D₆, D₇, D₈, D₉, D₁₀
- 值为：0, 1, 0, 0, 1, 1
- $P4 = 0 \oplus 1 \oplus 0 \oplus 0 \oplus 1 \oplus 1 = 1$

第四步：得出最终的海明码
将计算出的校验位填入表格：

| 位置 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 类型 | P₁ | P₂ | D₁ | P₃ | D₂ | D₃ | D₄ | P₄ | D₅ | D₆ | D₇ | D₈ | D₉ | D₁₀ |
| **数值** | **1** | **1** | 1 | **0** | 0 | 1 | 1 | **1** | 0 | 1 | 0 | 0 | 1 | 1 |

**最终发送的海明码为**: 11100111010011
- --

2. 海明纠错过程

第一步：模拟错误
假设在传输过程中，**第6位**发生了翻转，从 1 变成了 0。
- **发送的码**: 11100111010011
- **接收的码**: 11100011010011

第二步：接收端进行差错校验
接收端使用同样的方法计算新的校验位 $C1, C2, C3, C4$ 。
- **计算 C₁** (校验位置 1, 3, 5, 7, 9, 11, 13)
- 值为：1, 1, 0, 1, 0, 0, 1
- $C1 = 1 \oplus 1 \oplus 0 \oplus 1 \oplus 0 \oplus 0 \oplus 1 = 0$
- **计算 C₂** (校验位置 2, 3, 6, 7, 10, 11, 14)
- 值为：1, 1, **0**, 1, 1, 0, 1
- $C2 = 1 \oplus 1 \oplus 0 \oplus 1 \oplus 1 \oplus 0 \oplus 1 = 1$
- **计算 C₃** (校验位置 4, 5, 6, 7, 12, 13, 14)
- 值为：0, 0, **0**, 1, 0, 1, 1
- $C3 = 0 \oplus 0 \oplus 0 \oplus 1 \oplus 0 \oplus 1 \oplus 1 = 1$
- **计算 C₄** (校验位置 8, 9, 10, 11, 12, 13, 14)
- 值为：1, 0, 1, 0, 0, 1, 1
- $C4 = 1 \oplus 0 \oplus 1 \oplus 0 \oplus 0 \oplus 1 \oplus 1 = 0$

第三步：定位错误
将计算出的校验结果 $C4 C3 C2 C1$ 组合起来，得到错误位置的二进制码。
- $C4 C3 C2 C1 = 0110$
- 将二进制 0110 转换为十进制： $0 \times 8 + 1 \times 4 + 1 \times 2 + 0 \times 1 = 6$ 。

**结论**: 错误发生在**第6位**。

第四步：纠正错误
接收端找到第6位，将其翻转（从 0 变回 1）。
- **纠正后的码**: 11100111010011
- 这个结果与原始发送的海明码完全一致，纠错成功。
+ **差错控制协议 - 反馈纠错**
- **原理**：接收方检测到错误后，通过反馈信道通知发送方重传出错的数据帧。

#### 差错控制协议*
+ **停等协议** (Stop-and-Wait)
- **原理**：发送方发送一帧后，必须停止发送，等待接收方的确认（ACK）。收到ACK后才能发送下一帧。如果超时仍未收到ACK，则重传该帧。使用1比特序号（0和1）来区分新帧和重传帧。
- **效率**：信道利用率 $T=Tr+2Tp$ ，其中 $Tr$ 是帧传输时间， $Tp$ 是单向传播延迟。在高带宽或长延迟的信道中效率极低。

+ **滑动窗口协议** (Sliding Window)
- **原理**：允许发送方连续发送多个帧而无需等待确认，这些可以发送但还未被确认的帧的序号集合称为“发送窗口”。
- **流量控制**：窗口大小限制了未经确认的帧的数量。
- **差错控制**：
 1. **回退N协**议 (Go-Back-N)**：接收方只按序接收帧。一旦检测到某个帧出错或丢失，它会丢弃该帧及其之后收到的所有帧。发送方超时或收到否定确认（NAK）后，**从出错的那个帧开始重传所有后续帧**。

 2. **选择性重传协**议 (Selective Repeat)**：接收方可以缓存失序的正确帧。当检测到某个帧出错或丢失时，**只请求发送方重传那一个帧**。

### 4、流量控制
+ **原理**：确保发送方的发送速率不会超过接收方的处理能力，**防止接收方缓存溢出**。 
+ **停等协议中的流量控制**：天然实现了流量控制，因为发送一帧后必须等待，给予了接收方充足的处理时间。
+ **滑动窗口协议中的流量控制**：通过接收窗口的大小来实现。接收方可以根据自身缓存情况，通过确认帧来通告其还能接收多少帧（即调整发送方的发送窗口大小）。HDLC中的RNR（未准备好接收）帧就是一种显式的流量控制机制。 

### 5、链路控制协议*
+ **HDLC (高级数据链路控制)**
- **特点**：面向比特的同步协议，采用位填充。**支持点对点和多点链路，提供可靠的面向连接服务**。
- **帧类型**：
 * **信息帧 (I-Frame)**：用于传输数据，包含发送序号和接收序号（用于捎带应答）。
 * **监控帧 (S-Frame)**：用于流量控制和差错控制，如RR（确认）、REJ（否认）、RNR（未准备好接收）。
 * **无编号帧 (U-Frame)**：用于链路的建立和拆除，如SABM（建链）、DISC（拆链）。

+ **PPP (点对点协议)**
- **名字**：Point-to-Point Protocol。
- **特点**：
 * 字节导向的协议，字符填充，常用于异步串行线路（如拨号上网）。 
 * 不提供复杂的差错控制和流量控制，设计简单。 
 * 包含一个**链路控制协议 (LCP)** 用于建立、配置和测试数据链路连接。 
 * 包含一系列**网络控制协议 (NCPs)** 用于为不同的网络层协议（如IP, IPX）建立和配置连接。 
 * 支持身份认证（PAP, CHAP）。 
- **帧格式**：与HDLC类似，但控制字段和地址字段通常是固定的，并增加了一个协议字段来标识网络层协议。

### 6、协议描述和验证
+ **有限状态机 (Finite State Machine, FSM)**
- **定义**：一种用于精确、无歧义地描述协议行为的数学模型。它将协议实体的行为抽象为有限个**状态 (State)**、在状态间转换的**事件 (Event)** 以及由事件触发的**动作 (Action)**。
- **作用**：协议验证：1. 可靠性；2. 完备性。
- **状态转移图**：FSM的可视化表示。节点代表状态，有向边代表状态转换，边上的标签 事件/动作 表示在当前状态下，若发生某个事件，则执行相应动作并转移到下一个状态。 
- **能读懂状态转移图**：能够根据图示，追踪协议在不同事件序列下的行为路径，理解协议的逻辑。例如，TCP的状态转移图 完整地描述了TCP连接从建立到关闭的所有可能路径。

### 7、计算类型
+ **成帧开销**：
- **位填充**：开销不固定，取决于数据中 11111 模式出现的频率。
- **字符填充**：开销不固定，取决于数据中特殊字符（FLAG, ESC）出现的频率。
+ **协议效率与参数**：
- **停等协议效率**： eta=fracTtTt+2Tp=fracN/RN/R+2D/V ，其中N为帧长，R为速率，D为距离，V为传播速度。 
- **滑动窗口大小与序号**：
 * 为防止新旧窗口的序号重叠造成混淆，窗口大小 W 和序号位数 n 必须满足： W<2n−1 。
 * 对于Go-Back-N，发送窗口 Wsle2n−1 。
 * 对于选择性重传，发送窗口 Ws + 接收窗口 Wrle2n ，通常设 Ws=Wr=2n−1 。
- **例题**
 * **问题**：在一条 64Mbps 的链路上使用停等协议，帧大小为32KB，地球到行星距离为 9times1010 米。求信道利用率和为达到100%利用率所需的发送窗口大小。
 * **解**：
- --

## 第四章 介质访问子层 (MAC) 
### 1、介质访问子层的功能*
+ 控制广播信道中信道分配，制定数据发送和接收的规则。

数据链路层被分为两个子层：逻辑链路控制 (LLC) 子层和介质访问控制 (MAC) 子层。 

+ **广播式信道** (Broadcast Channel)
- **问题背景**：当多个站点（计算机）共享同一条物理通信信道时，就形成了广播信道。如果多个站点同时发送数据，就会发生**冲突 (Collision)**，导致数据损坏。
- **MAC子层的功能**：其核心功能就是解决**如何分配广播信道的使用权**的问题，即制定一套规则，决定下一个时刻哪个站点可以使用信道发送数据，从而避免或解决冲突。 
+ **广播信道的分配**
- **静态分**配 (Static Allocation)**(P10-P13)
 * **原理**：在通信开始前，将信道资源（如时间、频率）预先、固定地分配给各个站点。典型的技术是多路复用技术：**频分多路复用 (FDM)** 和**时分多路复用 (TDM)**。
 * **特点**：简单，不会产生冲突。但效率低下，尤其是在计算机网络中数据具有**猝发性**（时而有大量数据，时而空闲）的情况下，会造成大量信道资源浪费和不必要的较大延迟。多路访问难以实现。
- **动态分**配 (Dynamic Allocation)**(P8, P15)
 * **原理**：不进行预先分配，所有站点共享一个信道。当一个站点需要发送数据时，它会按照一套公共的协议去尝试获得信道使用权。
 * **特点**：信道利用率高，能很好地适应数据的猝发特性，是本章的重点。多路访问的简单实现

### 2、竞争式协议的原理和特点
竞争式协议是动态分配的一种，其核心思想是“先到先得”，允许冲突发生，并通过协议机制来解决冲突。

+ **ALOHA协议**(P19-P22)
- **原理**：最简单的竞争协议。站点有数据就直接发送，然后等待确认。如果发生冲突（通过未收到确认或定时器超时来判断），则等待一个随机时间后重传。
- **特点**：非常简单，但冲突概率极高，信道利用率很低（纯ALOHA最大为18.4%）。
- **时隙ALOHA (Slotted ALOHA)**(P23-P24)：将时间划分为离散的时隙，规定所有站点只能在时隙开始的时刻发送。这使得冲突窗口减半，信道利用率翻倍（最大为36.8%）。

+ **载波侦听多路访问 (CSMA)**(P26-P34)
- **原理**：“先听再说”。站点在发送数据前，先**侦听 (Listen)** 信道是否有载波信号。
 * 如果信道**空闲**，则发送。
 * 如果信道**忙**，则等待。
- **特点**：通过侦听大大降低了冲突的概率。但由于信号传播存在延迟，仍然可能发生冲突（例如，A发送的信号还未到达B，B侦听到信道空闲也开始发送）。
- **三种坚持策略**：
 1. **1-坚持 CSMA**：信道忙则持续侦听，一旦空闲立即发送。缺点是若有多个站点在等待，一旦信道变空闲，它们会同时发送，导致必然冲突。
 2. **非坚持 (0-坚持) CSMA**：信道忙则放弃侦听，等待一个随机时间后再回来侦听。优点是减少了冲突，但可能增加延迟。
 3. **p-坚持 CSMA**：信道忙则持续侦听，一旦空闲，以概率 p 发送，以概率 1−p 延迟一个时间单位再侦听。是前两者的折中。

+ **带冲突检测的CSMA (CSMA/CD)**(P35-P39)
- **原理**：“边听边说，冲突即停”。在CSMA的基础上，要求站点在**发送数据的同时**，继续侦听信道。
 * 如果检测到冲突（例如，收到的信号与自己发送的信号不一致），立即**停止发送**，并发送一个简短的拥塞信号通知所有站点。

 * 之后，等待一个随机时间（使用**二进制指数退避算法**）再重新尝试发送。
- **特点**：通过立即停止发送，大大减少了因冲突而浪费的信道时间，显著提高了信道利用率。是以太网的核心技术。
+ **带冲突避免的CSMA (CSMA/CA)**(P41-P44)
- **原理**：“请求再发，确认后发”。主要用于无线局域网。由于无线信道的复杂性（如“隐藏站”和“暴露站”问题），冲突检测非常困难且不可靠，因此协议的重点在于**避免冲突 (Collision Avoidance)**。
- **机制**：
 1. 站点在发送数据前，先侦听信道。如果信道空闲，则等待一段很短的随机时间后，再发送数据。？
 2. **RTS/CTS握手 (可选)**：为解决隐藏站问题，发送方可以先发送一个很短的**请求发送 (RTS)** 帧给接收方。
 3. 接收方收到RTS后，会广播一个**清除发送 (CTS)** 帧。
 4. 发送方收到CTS后，才开始发送正式的数据帧。
 5. 所有能听到CTS的站点（包括潜在的隐藏站）在CTS帧所指示的时间内都将抑制发送，从而避免了冲突。
- **特点**：通过RTS/CTS机制和随机退避，主动避免冲突的发生，适用于无线环境。

### 3、竞争协议、无冲突协议、有限竞争协议
+ **竞争协议与无冲突协议的比较**
- **竞争协**议 (Contention Protocols)**：如ALOHA, CSMA/CD。
 * **低负载时**：网络中站点少，数据量小。冲突概率低，站点一旦有数据几乎可以立即发送，因此**延迟低，性能好**。
 * **高负载时**：网络繁忙。冲突概率急剧增加，大量信道带宽被用于冲突和重传，**效率急剧下降**。
- **无冲突协**议 (Collision-Free Protocols)**：如轮询、令牌传递、二进制倒计数法 (P51-P54)。
 * **原理**：通过某种机制（如令牌）严格控制信道使用权，保证在任何时刻只有一个站点能发送数据，从而完全避免冲突。
 + **预定协议 (信道申请)**：将时间分为预定阶段和传输阶段。站点在预定阶段通过“位图法”等方式预约时隙，然后在传输阶段按序发送。
 + **自定方式 (二进制倒计数法)**(P52, P53)：各发送站发送自己的地址，同时监听自己发出的地址是否改变；地址发完后，没有发现地址改变的发送站继续发送数据。
 + **用特定信息指挥发送（令牌）**：一个称为“令牌”的特殊控制帧在站点间按逻辑环路传递，只有持有令牌的站点才能发送数据。
 * **低负载时**：即使只有一个站点有数据，它也必须等待轮到自己（例如，等待令牌传递一圈），因此**延迟高，效率低**。
 * **高负载时**：信道被充分利用，没有冲突开销，**信道利用率高，性能好**。
+ **有限竞争协议** (Limited Contention Protocols)
- **思想**：结合了竞争协议和无冲突协议的优点，试图在各种负载下都获得较好的性能。
- **原理**：在低负载时，协议的行为类似于竞争协议，允许站点自由竞争信道。当负载变高、冲突增多时，协议会切换到一种更有序的方式，将站点分组或采用预留机制，限制参与竞争的站点数量，从而降低冲突，行为类似于无冲突协议。
- 分组分时隙法：分组：组数－－N 组内成员数－－M

组间用竞争方式，组内用无冲突方式

组间用无冲突方式（固定时隙），组内用竞争方式

### 4、桥、交换机的基本工作原理
+ **网桥 (Bridge)**(P97-P107)
- **工作层次**：工作在**数据链路层 (MAC子层)**。
- **基本原理**：
 1. **连接与隔离**：网桥用于连接两个或多个局域网段（LAN Segment），局域网间隔离成不同的冲突域。
 2. **过滤与转发**：网桥以**混杂模式**接收其所有端口上的所有帧。根据帧内目的地址转发。
 3. **透明网桥-逆向学习 (Backward Learning)**：网桥通过检查收到的每一个帧的**源MAC地址**，来自动学习哪个MAC地址的设备位于哪个端口，并建立一个**转发表 (MAC地址表)**。
 4. **决策**：
 + 如果帧的**目的MAC地址**与**源MAC地址**在转发表中显示位于**同一端口**，说明这是网段内部通信，网桥会**丢弃 (过滤)** 该帧，不进行转发。
 + 如果目的MAC地址位于**不同端口**，网桥会将该帧**转发**到对应的端口。
 + 如果目的MAC地址在转发表中**找不到**（未知地址），或目的地址是**广播/多播地址**，网桥会将该帧向**除源端口外的所有端口泛洪 (Flooding)**。
- **生成树协议 (Spanning Tree Protocol)**(P104-P105)：为防止在有冗余链路的网络中形成转发环路，网桥之间会运行生成树协议，逻辑上阻塞某些端口，将网络拓扑修剪成一棵无环的树。
+ **交换机** (Switch)**(P108-P110)
- **基本原理**：交换机本质上是一个**多端口的、高速的、用硬件实现的网桥**。
- **与网桥的区别**：
 * **端口数量**：较多端口：交换机通常有几十个端口，而网桥通常只有2-4个。
 * 交换机一般在相同类型的LAN端口间交换数据（不进行协议转换）
 * 交换机可能采用部分存储转发技术，加快交换效率
 * **性能**：交换机使用专用的硬件芯片 (ASIC) 进行转发，速度远高于用软件实现的网桥。
 * **转发方式**：除了存储转发，交换机还支持“直通式 (Cut-Through)”转发，即只接收到目的MAC地址就立即开始转发，延迟更低。
 * **冲突域**：每个交换机端口都是一个独立的冲突域。如果一个端口只连接一台设备，并工作在全双工模式下，那么这个端口上就完全没有冲突。
- --

## 第五章 网络层
### 1、网络层的功能* 
网络层的主要任务是实现数据分组从源端主机到目的端主机的传输，为上层（传输层）提供服务。其核心功能包括：

+ **寻址 (Addressing)**：为网络中的每一个节点（主机、路由器）分配唯一的逻辑地址（如IP地址），用于标识和定位节点。 
+ **路由选择 (Routing)**：当分组从源到目的存在多条路径时，网络层通过路由算法为分组选择一条最佳路径。这包括**传播路径信息、形成路径（拓扑信息）**（Routing）以及**在路径中选择**（Routed）。 
+ **拥塞控制 (Congestion Control)**：监控网络状态，当网络中分组过多，导致性能下降时，采取措施缓解或避免拥塞。 
+ **网际互联 (Internetworking)**：连接多个异构的网络（如以太网、X.25网），屏蔽底层网络的差异，形成一个统一的、逻辑上的大网络，实现跨网络通信。 

### 2、两大阵营和技术路线*
1. 电路交换
+ 在通信期间，在源和目的之间建立一条专用通路
+ 通信过程具有三个阶段（面向连接）
+ 面向流，数据在经过交换节点时只有传播延迟
+ 收到一个信号几乎可以立即发送出去
2. 分组交换
+ 以分组为单位：将待传数据切分成较小的分组
+ 各分组在每个交换节点上：存储转发，逐站寻径
+ 分组在经过交换节点时，有存储转发的延迟，也有为每个分组寻径的延迟

网络层服务的设计思想主要分为两大阵营： 

1. **电信阵营（面向连接）**：强调网络的可靠性，认为通信子网应为终端提供可靠的通信服务。这导致了**虚电**路 (Virtual Circuit)** 技术路线。
2. **计算机网络/IETF阵营（无连接）**：认为网络本身是不可靠的，可靠性应由终端（上层协议）来保证。这导致了**数据**报 (Datagram)** 技术路线。

#### 虚电路与数据报的对比 
| **特性** | **虚电路 (Virtual Circuit)** | **数据报 (Datagram)** |
| --- | --- | --- |
| **连接建立** | 通信前必须先建立一条逻辑连接（虚电路）。面向连接 | 无需建立连接，直接发送分组。无连接 |
| **分组路径** | 同一连接的所有分组都沿同一条虚电路路径传输。 | 每个分组独立选择路由，路径可能不同。 |
| **分组顺序** | 按序到达。 | 可能失序到达。 |
| **可靠性** | 网络内部提供差错控制和流量控制，可靠性较高。 | 网络层不保证可靠性，“尽力而为”。 |
| **路由决策** | 仅在建立连接时进行一次路由选择，后续分组快速转发。 | 每个分组到达每个路由器时都要进行路由选择。 |
| **节点故障** | 路径上任一节点故障，虚电路即中断，需重建。 | 健壮性强，可绕过故障节点选择新路径。 |
| **地址开销** | 分组头部只需携带短的虚电路标识符，开销小。 | 每个分组都需携带完整的源和目的地址，开销大。 |
| **拥塞控制** | 容易实现，可在建立连接时预留资源。 | 较难实现，需要复杂的动态控制机制。 |
| **原型** | 电话系统 | 邮政系统 |

### 3、路由表
路由表是路由器进行路由选择的核心依据，存储了到达目的网络的路径信息。

+ **核心要素
- **目的网络/地址 (Destination)**：要去往的目标网络地址。
- **下一跳地址 (Next Hop)**：为了到达该目的，当前分组应该被转发到的下一个路由器的地址。
- **接口 (Interface)**：分组应该从当前路由器的哪个物理端口发送出去。
- **度量/距离 (Metric)**：到达该目的地的成本，如跳数、延迟、带宽等，用于选择最佳路径。

### 4、路由选择*
+ **路由选择算法特征**
- **正确性**：能将分组送到正确的目的地。
- **简单性**：算法开销小，易于实现。
- **健壮性**：能容忍网络拓扑变化、节点或链路故障。
- **稳定性**：条件不变，路由结果不变；条件变化，能形成新结果。
- **公平性**：对所有节点公平分配网络资源。
- **最佳性**：能为分组计算出“最优”路径。
+ **最优化原则** (Optimality Principle)
- **如果路由器J位于从路由器I到K的最优路径上，那么从J到K的最优路径也必定是这条路径的一部分。** 这个原则是所有最短路径算法的基础，保证了分布式路由决策的一致性。

### 5、路由选择算法*
+ **分类**：**静态与动态算法**(P44, P51)
- **静态路由 (Static Routing)**：由网络管理员手动配置路由表。算法简单，但不能适应网络拓扑的变化，适用于小型、稳定的网络。
- **动态路由 (Dynamic Routing)**：路由器之间通过交换路由信息来自动学习网络拓扑，根据网络运行的情况，动态更新路由表。能适应网络变化，但算法复杂，有额外开销。变化较频繁、规模较大、拓扑复杂的网络。
+ **扩散算法** (Flooding)
- **原理**：一种简单的静态路由方法。当一个路由器收到一个分组后，它会将该分组向除入口外的所有出口转发。
- **特点**：非常健壮，总能找到路径（如果存在的话），但会产生大量重复分组，造成网络风暴。通常需要TTL（生存时间）机制来防止无限循环。

+ **距离矢量算法 (Distance Vector Routing)**(P60-P66)
- **原理**：每个路由器维护一张路由表，包含到每个目的网络的**距离（度量值）和方向（下一跳）**。路由器定期与**相邻**的路由器交换**整个路由表**。收到邻居的路由表后，根据贝尔曼-福特算法更新自己的路由表：对于每个目的，比较经过不同邻居到达的距离，选择最短的路径。
- **计算**：我到目的X的距离 = 我到邻居Y的距离 + Y告诉我的它到X的距离。
- **例题**：
 * **场景**：节点1的初始路由为 { , }。它收到邻居节点3发来的路由信息 { (目的4, 距离1), (目的5, 距离1) }。
 * **计算**：
 + 节点1到节点3的距离是1。
 + 通过节点3到达节点4的新路径距离 = 1(to 3)+1(3 to 4)=2。
 + 通过节点3到达节点5的新路径距离 = 1(to 3)+1(3 to 5)=2。
 + 节点1更新自己的路由表，添加/更新到4和5的路由，下一跳都指向3。
+ **链路状态算法 (Link State Routing)**(P73-P82)
- **原理**：每个路由器首先发现它的邻居，并测量到邻居的链路成本（如延迟）。然后，将这些信息（“我是谁，我的邻居是谁，成本是多少”）打包成一个**链路状态分组 (LSP)**，并**泛洪**给网络中的**所有**其他路由器。每个路由器都收集所有LSP，从而构建出完整的网络拓扑图。最后，每个路由器独立地在本地运行**Dijkstra最短路径算法**，计算出以自己为根的到所有其他节点的最短路径树，生成路由表。
- **计算 (Dijkstra算法)**：
 1. 初始化：将源节点距离设为0，其他节点设为无穷大。
 2. 从未知节点中选择一个距离最小的节点（记为u），将其标记为已知。
 3. 对于u的所有未知邻居v，更新v的距离：如果 (u的距离 + u到v的成本) < v的当前距离，则更新v的距离和路径。
 4. 重复步骤2和3，直到所有节点都被标记为已知。
- **例题**：

### 6、特殊问题的路由方法
+ **广播路由 (Broadcast Routing)**：将一个分组发送给网络中的所有节点。可以**基于生成树**进行，避免环路和不必要的重复。
+ **多播路由 (Multicast Routing)**：将一个分组发送给一个特定的主机组（多播组）。通过**构建多播树（有源树或共享树）** 来实现高效转发。
+ **移动路由 (Mobile Routing)**：处理主机在不同网络间移动时的路由问题。通常使用“本地代理”和“外地代理”来**截获**发往移动主机的数据包，并通过**隧道技术**转发到其当前位置。

### 7、拥塞控制
+ **什么是拥塞**：**指网络节点中出现大量分组堆积、等待传输的现象**。
+ **拥塞控制与流量控制**：
- **流量控制**是点对点的问题，确保发送方不会淹没接收方。
- **拥塞控制**是全局性问题，确保整个网络（或子网）能够承载所有通信。

+ **开环与闭环方法**(P103, P104)
- **开环方法**（**预防**）：在设计网络时就采取措施来避免拥塞，不依赖于当前网络状态的反馈。例如，预先为连接分配资源。
- **闭环方法**（**检测和采取措施**）：基于对当前网络状态的监测和反馈来动态调整。包括三个步骤：①监测网络拥塞；②将拥塞信息传递给能采取行动的地方；③调整网络行为以纠正问题。

+ **拥塞控制方法**
- **漏桶算法 (Leaky Bucket)**：以匀速间隔向网络送入数据，可以任意速率接收用户数据。
- **令牌桶算法 (Token Bucket)**：允许一定的突发传输。系统以固定速率生成令牌放入桶中，发送分组需要消耗令牌。只要桶中有令牌，就可以发送，允许短时间的突发。
- **警告位/抑制分组**：路由器检测到拥塞时，在转发的分组中设置一个“警告位”或直接向源主机发送一个“抑制分组”，要求其降低发送速率。

### 8、网络互联
+ **网络的不同和互联的需求**(P117-P119)：现实世界存在多种异构网络（不同的地址方案、最大分组长度MTU、服务模型等），需要通过网关（路由器）将它们互联起来，形成一个统一的互联网。

+ **互联技术**
- **协议转换 (Protocol Conversion)**：网关在两个网络之间充当“翻译”，将一个网络的协议格式和语义完全转换成另一个网络的。实现非常复杂，通常只在**协议非常相似**时才可行。
- **隧道技术 (Tunneling)**：当两个同构网络（如两个IPv6网络）需要通过一个异构网络（如IPv4网络）连接时使用。将源网络的分组（整个IPv6包）作为数据，封装在一个中间网络的分组（IPv4包）中进行传输，到达对端后再解封。中间网络对封装的数据是透明的。
- **协议覆盖 (Protocol Overlay)**：在所有异构的底层网络之上，运行一个统一的、共同的**网络层协议**（如IP协议），从而屏蔽掉底层网络的差异。这是Internet实现全球互联的核心思想。

+ **分段 (Fragmentation)**(P149-P153)
- **问题**：MTU（ Max Transmit Unit）－－网络最大传输单元。当一个大的分组要从一个MTU较大的网络进入一个MTU较小的网络时，必须进行分段。
- **透明分段**：分段和重组都在子网内部完成。分组在进入小MTU网络时被分段，在离开该网络前被重组。对外部网络是透明的。
- **不透明分段**：分段由进入小MTU网络的网关执行，但重组由最终的目的主机完成。这是**IP协议**采用的方式。
- **计算**：
 * **问题**：一个2000字节的数据包（20字节头部 + 1980字节数据）要通过一个MTU为500字节的网络。
 * **解（IP方式）**：
 + 每个分片最多能携带的数据 = 500−20=480 字节。注意数据长度必须是8的倍数。
 + **分片1**：20字节头部 + 480字节数据。
 + **分片2**：20字节头部 + 480字节数据。
 + **分片3**：20字节头部 + 480字节数据。
 + **分片4**：20字节头部 + 480字节数据。
 + **分片5**：20字节头部 + 60字节数据 ( 1980−4×480=60 )。
 + 共产生5个分片。
+ **防火墙技术 (Firewall)**(P154-P157)
- **原理**：位于网络边界（如公司内网与Internet之间）的设备，根据预设的安全策略，对进出网络的流量进行**过滤**，允许授权的流量通过，阻止未授权或有潜在危险的流量。
- --

## 第六章 传输层
### 1、传输层功能* (P4, P8)

传输层位于网络层之上，应用层之下，是OSI模型中负责端到端通信的核心层次。其主要功能是为运行在不同主机上的**应用程序进程**之间提供一种**端到端**的通信服务。

+ **核心服务**：屏蔽底层各种通信子网的差异和细节，为上层应用提供一个统一、可靠或不可靠的通信接口。
+ **进程间通信**：网络层提供的是主机到主机的通信，而传输层提供的是主机上**进程到进程**的通信。
+ **复用与分流**：
- **复用 (Multiplexing)**：将多个上层应用进程的数据流合并，通过同一个网络层连接进行传输，以节约网络资源。
- **分流 (Demultiplexing)**：在接收端，传输层根据端口号等标识，将收到的数据准确地分发给对应的应用程序进程。
+ **提供两种服务模式**：
- **面向连接的服务**：提供可靠的、按序的字节流传输（如TCP）。
- **无连接的服务**：提供“尽力而为”的数据报传输，不保证可靠性和顺序（如UDP）。

### 2、传输层与数据链路层的比较

虽然两者都提供**差错控制、流量控制和连接管理**等功能，但它们的工作环境和面临的挑战有本质区别。 

+ **通信对象**：
- **数据链路层**：负责**直接相连**的两个节点（点到点信道）之间的通信。
- **传输层**：负责网络中**任意两个终端主机**（端到端信道）之间的通信，中间可能跨越多个网络和路由器。
+ **报文的延迟和重复现象**(P21, P26)
- **数据链路层**：工作在**物理信道**上，传输延迟相对固定且较小，通常不会出现报文的存储和复制。
- **传输层**：其下的通信子网（网络层）是一个复杂的环境，具有“存储效应”。路由器会缓存和转发分组，当网络拥塞或路由改变时，可能导致：
 * **延迟大且动态变化**：分组在网络中的延迟不固定，变化范围很大。
 * **报文重复**：网络可能会传递一个分组的多个副本。
 * **报文失序**：后发的分组可能先于先发的分组到达。
- 这些现象，特别是**延迟的重复分组 (delayed duplicate packets)**，给传输层的协议设计（如连接管理、序号分配）带来了远比数据链路层复杂的挑战。

### 3、寻址：TSAP的设置方案
网络层的地址（如IP地址）只能标识主机，为了区分主机上的不同应用程序进程，传输层引入了**传输服务访问**点 (Transport Service Access Point, TSAP)**，在TCP/IP协议中通常称为**端口 (Port)**。 

+ **TSAP的作用**：在主机地址的基础上，提供了一个用于标识应用程序的地址。一个完整的通信地址由 (网络层地址, TSAP) 构成。
+ **TSAP的设置方案**(P18-P20)
 1. **预置固定TSAP**：为广为人知的标准服务（如HTTP、FTP、SMTP）分配固定的、熟知的TSAP（端口号）。客户端可以直接向这些端口发起连接。
 2. **进程服务器 (Process Server)**：主机上运行一个特殊的“总机”进程，它监听一系列TSAP。当有连接请求到达时，它会为该请求创建（fork）一个新的服务器进程来处理，并将连接移交给新进程。
 3. **名字服务器** (Name Server)**：更灵活的方式。服务器进程启动时，向一个“名字服务器”（类似114查号台）注册自己的服务名称和动态分配的TSAP。客户端先向名字服务器查询特定服务的TSAP，然后再用获取到的TSAP与服务器建立连接。

### 4、建立连接
#### 三次握手 (Three-Way Handshake) 
在不可靠的网络上建立可靠的传输连接，需要**三次交互来同步双方的初始序号** (Initial Sequence Number, ISN)。

+ **过程**：
 1. **第一次握手 (SYN)**：客户端A向服务器B发送一个连接请求报文段 (CR, Connection Request)，其中包含A选择的初始序号 x 。
 2. **第二次握手 (SYN+ACK)**：服务器B收到请求后，回送一个确认报文段 (ACK)，其中确认号为 x ，表示收到了A的请求。同时，B也选择自己的初始序号 y 并包含在报文段中。
 3. **第三次握手 (ACK)**：客户端A收到B的确认后，再发送一个确认报文段给B，其中确认号为 y ，表示收到了B的序号。
+ **为什么要三次握手？**
- **防止旧连接请求的干扰**：最主要的原因是为了防止已失效的连接请求报文段（在网络中长时间滞留后又到达服务器）引发错误。如果是两次握手，服务器收到旧的请求后会立即建立连接并等待数据，造成资源浪费。而在三次握手下，服务器回送SYN+ACK后，客户端A发现这不是自己当前发起的连接，就不会发送第三次握手，服务器也就不会建立连接。
- **同步双方初始序号**：三次握手确保了双方都知道对方已经准备好，并且双方的初始序号都得到了对方的确认。

#### 序号的禁止区 (Forbidden Region) 
+ **问题背景**：由于网络存在最大分组生命周期 (T)，一个旧连接中序号为 S 的分组，最晚可能在 T 秒后才消失。如果在主机崩溃重启后，立即使用与旧连接重叠的序号范围，就可能收到这个“僵尸分组”，并误认为它是新连接的有效分组。
+ **禁止区的含义**：为了解决这个问题，协议规定在重启后的 T 秒内，所有可能与旧连接“僵尸分组”序号重叠的区域都不能使用。这个不能使用的序号范围就称为**禁止区**。
+ **实现方法**：通常使用一个与时间相关的时钟来生成初始序号。时钟不断前进，确保新连接的初始序号会远离旧连接的序号。当发送一个序号为 S 的分组时，必须确保在当前时间，序号 S 不在禁止区内。如果进入了，就必须等待足够的时间，让旧的“僵尸分组”彻底消亡后，再使用该序号。

### 5、释放连接

+ **非对称释放** (Asymmetric Release)**(P34, P35)
- **原理**：连接的一方发送一个断开请求 (DR, Disconnection Request) 后，就单方面关闭了整个双向连接。
- **缺点**：非常危险，可能会导致**数据丢失**。例如，A向B发送DR时，B可能还有数据正在发往A的路上，A的单方面关闭会导致这些数据丢失。
+ **对称释放** (Symmetric Release)**(P34, P36-P39)
- **原理**：将双向连接看作两个独立的单向连接，每一方都独立地**关闭自己向对方发送数据的通道**。
- **过程**：
 1. A发送FIN（结束）报文，表示A不再发送数据，进入半关闭状态，但仍可接收数据。
 2. B收到FIN后，回送ACK确认。
 3. 当B也没有数据要发送时，B也发送自己的FIN报文。
 4. A收到B的FIN后，回送ACK确认。至此，连接才完全关闭。
- **两军问题**：对称释放在理论上存在一个无法完美解决的问题。即无论双方确认多少次，最后发送确认的一方永远无法确定对方是否收到了这个最后的确认。在实践中，通过设置**定时器**来解决。例如，发送最后ACK的一方会等待一段时间（如2倍MSL），如果没收到对方的重传请求，就认为对方已成功收到，然后关闭连接。

## 第六章 其他 (开放式问题)
PPT本身未包含这些内容，以下为基于通用网络知识的简要总结：

+ **车联网 (Internet of Vehicles, IoV)**：将车辆与互联网连接起来，实现车与车(V2V)、车与路(V2R)、车与人(V2P)、车与云平台(V2I)之间的信息交换。其目标是提升交通安全、缓解拥堵、提供车载信息娱乐服务。
+ **自组网 (Ad Hoc Network)**：一种没有固定基础设施（如路由器、基站）的无线网络。网络中的节点既是终端也是路由器，它们可以自由移动并自动组织成网络。具有动态拓扑、分布式控制的特点。
+ **移动互联网 (Mobile Internet)**：指用户通过智能手机、平板电脑等移动终端，利用3G/4G/5G等移动通信技术接入互联网。其特点是服务的个性化、位置感知和随时在线。
+ **卫星网 (Satellite Network)**：利用人造地球卫星作为中继站来转发无线电信号，实现地面或空中终端之间通信的网络。其优点是覆盖范围广，不受地理限制；缺点是延迟大、成本高。
+ **软件定义网络 (Software-Defined Networking, SDN)**：一种新型的网络架构。它将网络的控制平面（决定数据包如何转发的大脑）与数据平面（实际转发数据包的硬件）相分离。通过一个集中的控制器，使用软件编程的方式来控制整个网络，使得网络管理更加灵活、智能和自动化。


